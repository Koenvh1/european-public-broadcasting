<!DOCTYPE html>
<html lang="en">
{% include "header.twig" %}
<body class="bg-white" style="overflow: hidden">
<video id="videoPlayer" autoplay controls data-dashjs-player controlsList="nodownload" crossorigin="anonymous" style="width: 100vw; height: 100vh; background: black"></video>
<div style="position: fixed; top: 0; right: 0; border-bottom-left-radius: 3px">
        <select class="languages" name="languages">

        </select>
</div>
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
<script src="https://cdn.dashjs.org/latest/dash.all.min.js"></script>
<script src="https://vjs.zencdn.net/7.5.5/video.js"></script>
<script src="js/vendor.js"></script>
<script src="js/app.js"></script>

<script src="js/nprogress.js"></script>
<script src="js/Player.js"></script>
<script src="js/Utils.js"></script>
{#<script src="js/language-switcher.js"></script>#}

<script>
    let p = new Player();
    p.load("{{ video|escape }}", "{{ caption|escape }}", {{ protection|json_encode }});

    const langs = Utils.getLanguages();
    const language = localStorage.getItem("language") || "en";

    const languagesContent = Object.entries(langs).map(lang =>
        `<option value="${lang[0]}" ${language === lang[0] ? "selected" : ""}>${lang[1]}</option>`
    ).join("\n");

    console.log(languagesContent);

    const $languages = document.querySelector(".languages");
    $languages.innerHTML = languagesContent;

    $languages.addEventListener("change", e => {
        const newLanguage = $languages.options[$languages.selectedIndex].value;
        localStorage.setItem("language", newLanguage);
        p.setLanguage(newLanguage);

        //alert("This only affects automatically translated texts at the moment");
        // location.reload();
    })
</script>
</body>
</html>